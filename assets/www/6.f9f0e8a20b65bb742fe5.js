(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{eoiU:function(e,o,s){"use strict";s.d(o,"a",(function(){return CoreSwipeNavigationItemsManager}));var i=s("mrSG"),n=s("pHTc"),t=s("CtbY");class CoreSwipeNavigationItemsManager extends t.a{start(){return Object(i.a)(this,void 0,void 0,(function*(){this.updateSelectedItem()}))}navigateToNextItem(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(1,"forward")}))}navigateToPreviousItem(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(-1,"back")}))}hasNextItem(){return Object(i.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(1))}))}hasPreviousItem(){return Object(i.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(-1))}))}getCurrentPageRoute(){return n.a.getCurrentRoute()}getSelectedItemPathFromRoute(e){const o=[];for(;e&&(o.push(...e.url),e.firstChild);)e=e.firstChild;return o.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,o){return Object(i.a)(this,void 0,void 0,(function*(){const s=yield this.getItemBy(e);s&&(yield this.navigateToItem(s,{animationDirection:o,replace:!0}))}))}getItemBy(e){var o;return Object(i.a)(this,void 0,void 0,(function*(){const s=this.getSource().getItems(),i=null!==(o=this.selectedItem&&(null==s?void 0:s.indexOf(this.selectedItem)))&&void 0!==o?o:-1;if(-1===i||null===s)return null;const n=e>0?1:-1;let t=i,c=0;for(;c!==e;){if(t+=n,t<0)return null;if(t>=s.length)break;this.skipItemInSwipe(s[t])||(c+=n)}return c===e?s[t]:this.getSource().isCompleted()?null:(yield this.getSource().load(),this.getItemBy(e))}))}skipItemInSwipe(e){return!1}}},uSYB:function(e,o,s){"use strict";s.r(o),s.d(o,"AddonForumNewDiscussionLazyModule",(function(){return B}));var i=s("tyNb"),n=s("AzLI"),t=s("MLi9"),c=s("ekpb"),d=s("L3Fv"),r=s("mrSG"),a=s("3Pt+"),u=s("fjkH"),l=s("mWdr"),m=s("pHTc"),h=s("ZCW2"),g=s("N5Lt"),p=s("pET4"),f=s("9+EE"),_=s("3LXp"),D=s("j3ag"),w=s("uT8i"),I=s("h709"),v=s("bFG1"),b=s("VF9H"),M=s("hSQQ"),P=s("vuGA"),A=s("4reR"),y=s("nFEd"),O=s("LVzu"),C=s("baaQ"),N=s("fXoL"),F=s("46ml"),E=s("TEn/"),T=s("nt/U"),S=s("OZH1"),G=s("PgjG"),x=s("ofXK"),V=s("3CSS"),j=s("ACYt"),L=s("hMzs"),k=s("M9y5"),R=s("sYmb");const z=["newDiscFormEl"];function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template(e,o){if(1&e){const e=N.Fc();N.Ec(0,"ion-item"),N.Ec(1,"ion-label"),N.pd(2),N.Pc(3,"translate"),N.Dc(),N.Ec(4,"ion-toggle",22),N.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template_ion_toggle_ngModelChange_4_listener(o){N.fd(e);return N.Oc(3).newDiscussion.postToAllGroups=o})),N.Dc(),N.Dc()}if(2&e){const e=N.Oc(3);N.lc(2),N.qd(N.Qc(3,2,"addon.mod_forum.posttomygroups")),N.lc(2),N.Vc("ngModel",e.newDiscussion.postToAllGroups)}}function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_ion_select_option_6_Template(e,o){if(1&e&&(N.Ec(0,"ion-select-option",26),N.zc(1,"core-format-text",27),N.Dc()),2&e){const e=o.$implicit,s=N.Oc(4);N.Vc("value",e.id),N.lc(1),N.Vc("text",e.name)("contextInstanceId",s.courseId)("wsNotFiltered",!0)}}const _c1=function(e){return{header:e}};function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template(e,o){if(1&e){const e=N.Fc();N.Ec(0,"ion-item",23),N.Ec(1,"ion-label"),N.pd(2),N.Pc(3,"translate"),N.Dc(),N.Ec(4,"ion-select",24),N.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template_ion_select_ngModelChange_4_listener(o){N.fd(e);return N.Oc(3).newDiscussion.groupId=o}))("ionChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template_ion_select_ionChange_4_listener(){N.fd(e);return N.Oc(3).calculateGroupName()})),N.Pc(5,"translate"),N.nd(6,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_ion_select_option_6_Template,2,4,"ion-select-option",25),N.Dc(),N.Dc()}if(2&e){const e=N.Oc(3);N.lc(2),N.qd(N.Qc(3,5,"addon.mod_forum.group")),N.lc(2),N.Vc("ngModel",e.newDiscussion.groupId)("disabled",e.newDiscussion.postToAllGroups)("interfaceOptions",N.ad(9,_c1,N.Qc(5,7,"addon.mod_forum.group"))),N.lc(2),N.Vc("ngForOf",e.groups)}}function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template(e,o){if(1&e){const e=N.Fc();N.Ec(0,"ion-item"),N.Ec(1,"ion-label"),N.pd(2),N.Pc(3,"translate"),N.Dc(),N.Ec(4,"ion-toggle",28),N.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template_ion_toggle_ngModelChange_4_listener(o){N.fd(e);return N.Oc(3).newDiscussion.pin=o})),N.Dc(),N.Dc()}if(2&e){const e=N.Oc(3);N.lc(2),N.qd(N.Qc(3,2,"addon.mod_forum.discussionpinned")),N.lc(2),N.Vc("ngModel",e.newDiscussion.pin)}}function AddonModForumNewDiscussionPage_form_15_div_21_core_attachments_9_Template(e,o){if(1&e&&N.zc(0,"core-attachments",29),2&e){const e=N.Oc(3);N.Vc("files",e.newDiscussion.files)("maxSize",e.forum.maxbytes)("maxSubmissions",e.forum.maxattachments)("component",e.component)("componentId",e.forum.cmid)("allowOffline",!0)("courseId",e.courseId)}}function AddonModForumNewDiscussionPage_form_15_div_21_Template(e,o){if(1&e){const e=N.Fc();N.Ec(0,"div",18),N.nd(1,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template,5,4,"ion-item",7),N.nd(2,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template,7,11,"ion-item",19),N.Ec(3,"ion-item"),N.Ec(4,"ion-label"),N.pd(5),N.Pc(6,"translate"),N.Dc(),N.Ec(7,"ion-toggle",20),N.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_Template_ion_toggle_ngModelChange_7_listener(o){N.fd(e);return N.Oc(2).newDiscussion.subscribe=o})),N.Dc(),N.Dc(),N.nd(8,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template,5,4,"ion-item",7),N.nd(9,AddonModForumNewDiscussionPage_form_15_div_21_core_attachments_9_Template,1,7,"core-attachments",21),N.Dc()}if(2&e){const e=N.Oc(2);N.lc(1),N.Vc("ngIf",e.showGroups&&e.groupIds.length>1&&e.accessInfo.cancanposttomygroups),N.lc(1),N.Vc("ngIf",e.showGroups),N.lc(3),N.qd(N.Qc(6,6,"addon.mod_forum.discussionsubscription")),N.lc(2),N.Vc("ngModel",e.newDiscussion.subscribe),N.lc(1),N.Vc("ngIf",e.canPin),N.lc(1),N.Vc("ngIf",e.canCreateAttachments&&e.forum&&e.forum.maxattachments>0)}}function AddonModForumNewDiscussionPage_form_15_ion_item_22_Template(e,o){if(1&e&&(N.Ec(0,"ion-item",30),N.zc(1,"ion-icon",31),N.Ec(2,"ion-label"),N.zc(3,"core-format-text",27),N.Dc(),N.Dc()),2&e){const e=N.Oc(2);N.lc(3),N.Vc("text",e.postInGroupMessage)("contextInstanceId",e.courseId)("wsNotFiltered",!0)}}function AddonModForumNewDiscussionPage_form_15_ion_col_26_Template(e,o){if(1&e){const e=N.Fc();N.Ec(0,"ion-col"),N.Ec(1,"ion-button",32),N.Mc("click",(function AddonModForumNewDiscussionPage_form_15_ion_col_26_Template_ion_button_click_1_listener(){N.fd(e);return N.Oc(2).discard()})),N.pd(2),N.Pc(3,"translate"),N.Dc(),N.Dc()}2&e&&(N.lc(2),N.qd(N.Qc(3,1,"core.discard")))}function AddonModForumNewDiscussionPage_form_15_Template(e,o){if(1&e){const e=N.Fc();N.Ec(0,"form",null,8),N.Ec(2,"ion-item"),N.Ec(3,"ion-label",9),N.pd(4),N.Pc(5,"translate"),N.Dc(),N.Ec(6,"ion-input",10),N.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_Template_ion_input_ngModelChange_6_listener(o){N.fd(e);return N.Oc().newDiscussion.subject=o})),N.Pc(7,"translate"),N.Dc(),N.Dc(),N.Ec(8,"ion-item"),N.Ec(9,"ion-label",9),N.pd(10),N.Pc(11,"translate"),N.Dc(),N.Ec(12,"core-rich-text-editor",11),N.Mc("contentChanged",(function AddonModForumNewDiscussionPage_form_15_Template_core_rich_text_editor_contentChanged_12_listener(o){N.fd(e);return N.Oc().onMessageChange(o)})),N.Pc(13,"translate"),N.Dc(),N.Dc(),N.Ec(14,"ion-item",12),N.Mc("click",(function AddonModForumNewDiscussionPage_form_15_Template_ion_item_click_14_listener(){N.fd(e);return N.Oc().toggleAdvanced()})),N.Pc(15,"translate"),N.zc(16,"ion-icon",13),N.Ec(17,"ion-label"),N.Ec(18,"h2"),N.pd(19),N.Pc(20,"translate"),N.Dc(),N.Dc(),N.Dc(),N.nd(21,AddonModForumNewDiscussionPage_form_15_div_21_Template,10,8,"div",14),N.nd(22,AddonModForumNewDiscussionPage_form_15_ion_item_22_Template,4,3,"ion-item",15),N.Ec(23,"ion-item",16),N.Ec(24,"ion-label"),N.Ec(25,"ion-row"),N.nd(26,AddonModForumNewDiscussionPage_form_15_ion_col_26_Template,4,3,"ion-col",7),N.Ec(27,"ion-col"),N.Ec(28,"ion-button",17),N.Mc("click",(function AddonModForumNewDiscussionPage_form_15_Template_ion_button_click_28_listener(){N.fd(e);return N.Oc().add()})),N.pd(29),N.Pc(30,"translate"),N.Dc(),N.Dc(),N.Dc(),N.Dc(),N.Dc(),N.Dc()}if(2&e){const e=N.Oc();N.lc(4),N.qd(N.Qc(5,20,"addon.mod_forum.subject")),N.lc(2),N.Vc("ngModel",e.newDiscussion.subject)("placeholder",N.Qc(7,22,"addon.mod_forum.subject")),N.lc(4),N.qd(N.Qc(11,24,"addon.mod_forum.message")),N.lc(2),N.Vc("control",e.messageControl)("placeholder",N.Qc(13,26,"addon.mod_forum.message"))("component",e.component)("componentId",e.forum.cmid)("autoSave",!0)("contextInstanceId",e.forum.cmid),N.lc(2),N.mc("aria-expanded",e.advanced)("aria-label",N.Qc(15,28,e.advanced?"core.hideadvanced":"core.showadvanced")),N.lc(2),N.qc("expandable-status-icon-expanded",e.advanced),N.lc(3),N.qd(N.Qc(20,30,"addon.mod_forum.advanced")),N.lc(2),N.Vc("ngIf",e.advanced),N.lc(1),N.Vc("ngIf",e.showGroups&&e.postInGroupMessage&&!e.newDiscussion.postToAllGroups),N.lc(4),N.Vc("ngIf",e.hasOffline),N.lc(2),N.Vc("disabled",""==e.newDiscussion.subject||null==e.newDiscussion.message),N.lc(1),N.rd(" ",N.Qc(30,32,"addon.mod_forum.posttoforum")," ")}}let Q=(()=>{class AddonModForumNewDiscussionPage{constructor(e,o){this.route=e,this.splitView=o,this.component=h.b.COMPONENT,this.messageControl=new a.g,this.groupsLoaded=!1,this.showGroups=!1,this.hasOffline=!1,this.canCreateAttachments=!0,this.canPin=!1,this.showForm=!1,this.groups=[],this.groupIds=[],this.newDiscussion={subject:"",message:null,postToAllGroups:!1,groupId:0,subscribe:!0,pin:!1,files:[]},this.advanced=!1,this.accessInfo={},this.isDestroyed=!1,this.forceLeave=!1}ngOnInit(){var e,o;return Object(r.a)(this,void 0,void 0,(function*(){try{const s=this.route.snapshot.data;if(this.courseId=m.a.getRequiredRouteNumberParam("courseId"),this.cmId=m.a.getRequiredRouteNumberParam("cmId"),this.forumId=m.a.getRequiredRouteNumberParam("forumId"),this.timeCreated=m.a.getRequiredRouteNumberParam("timeCreated"),this.initialGroupId=m.a.getRouteNumberParam("groupId"),this.initialGroupId=0===this.initialGroupId?h.b.ALL_PARTICIPANTS:this.initialGroupId,0!==this.timeCreated&&(null===(e=s.swipeEnabled)||void 0===e||e)){const e=C.a.getOrCreateSource(O.a,[this.courseId,this.cmId,null!==(o=s.discussionsPathPrefix)&&void 0!==o?o:""]);this.discussions=new new_discussion_AddonModForumNewDiscussionDiscussionsSwipeManager(e),yield this.discussions.start()}}catch(e){return _.a.showErrorModal(e),this.goBack(),void 0}this.fetchDiscussionData().finally((()=>{this.groupsLoaded=!0}))}))}ionViewDidEnter(){this.syncObserver||(this.syncObserver=u.b.on(p.b.AUTO_SYNCED,(e=>{e.forumId==this.forumId&&e.userId==f.c.getCurrentSiteUserId()&&(_.a.showAlertTranslated("core.notice","core.contenteditingsynced"),this.returnToDiscussions())}),f.c.getCurrentSiteId()))}fetchDiscussionData(e){return Object(r.a)(this,void 0,void 0,(function*(){try{const o=yield l.a.getActivityGroupMode(this.cmId),s=[];o===l.b.SEPARATEGROUPS||o===l.b.VISIBLEGROUPS?s.push(l.a.instance.getActivityAllowedGroups(this.cmId).then((e=>{let s;return s=o===l.b.VISIBLEGROUPS?this.validateVisibleGroups(e.groups):this.addAllParticipantsOption(e.groups,!0),s.then((e=>Object(r.a)(this,void 0,void 0,(function*(){if(e.length>0)return this.groups=e,this.groupIds=e.map((e=>e.id)).filter((e=>e>0)),this.newDiscussion.groupId=this.newDiscussion.groupId||this.getInitialGroupId(),this.showGroups=!0,yield this.calculateGroupName(),this.groupIds.length<=1&&(this.newDiscussion.postToAllGroups=!1),void 0;throw new Error(D.I.instant(o===l.b.SEPARATEGROUPS?"addon.mod_forum.cannotadddiscussionall":"addon.mod_forum.cannotadddiscussion"))}))))}))):(this.showGroups=!1,this.newDiscussion.postToAllGroups=!1,s.push(v.a.ignoreErrors(h.a.instance.canAddDiscussionToAll(this.forumId,{cmId:this.cmId}).then((e=>{this.canPin=!!e.canpindiscussions,this.canCreateAttachments=!!e.cancreateattachment}))))),s.push(h.a.getForum(this.courseId,this.cmId).then((e=>this.forum=e))),s.push(h.a.instance.getAccessInformation(this.forumId,{cmId:this.cmId}).then((e=>this.accessInfo=e))),yield Promise.all(s),this.timeCreated&&!e&&(this.syncId=p.a.getForumSyncId(this.forumId),yield p.a.waitForSync(this.syncId).then((()=>(this.isDestroyed||w.a.blockOperation(h.b.COMPONENT,this.syncId),I.a.instance.getNewDiscussion(this.forumId,this.timeCreated).then((e=>Object(r.a)(this,void 0,void 0,(function*(){if(this.hasOffline=!0,e.options=e.options||{},e.groupid==h.b.ALL_GROUPS?(this.newDiscussion.groupId=this.groups[0].id,this.newDiscussion.postToAllGroups=!0):(this.newDiscussion.groupId=e.groupid,this.newDiscussion.postToAllGroups=!1),this.newDiscussion.subject=e.subject,this.newDiscussion.message=e.message,this.newDiscussion.subscribe=!!e.options.discussionsubscribe,this.newDiscussion.pin=!!e.options.discussionpinned,this.messageControl.setValue(e.message),yield this.calculateGroupName(),"object"==typeof e.options.attachmentsid&&e.options.attachmentsid.offline){const e=yield b.a.getNewDiscussionStoredFiles(this.forumId,this.timeCreated);this.newDiscussion.files=e}(!this.newDiscussion.subscribe||this.newDiscussion.pin||this.newDiscussion.files.length||this.groups.length>0&&this.newDiscussion.groupId!=this.groups[0].id||this.newDiscussion.postToAllGroups)&&(this.advanced=!0)})))))))),this.originalData||(this.originalData={subject:this.newDiscussion.subject,message:this.newDiscussion.message,files:this.newDiscussion.files.slice()}),this.showForm=!0}catch(e){_.a.showErrorModalDefault(e,"addon.mod_forum.errorgetgroups",!0),this.showForm=!1}}))}validateVisibleGroups(e){return Object(r.a)(this,void 0,void 0,(function*(){let o;try{o=yield h.a.canAddDiscussionToAll(this.forumId,{cmId:this.cmId})}catch(e){o={status:!1,canpindiscussions:!1,cancreateattachment:!0}}if(this.canPin=!!o.canpindiscussions,this.canCreateAttachments=!!o.cancreateattachment,o.status)return this.addAllParticipantsOption(e,!1);const s=[],i=[];return e.forEach((e=>{s.push(h.a.instance.canAddDiscussion(this.forumId,e.id,{cmId:this.cmId}).catch((()=>({status:!0}))).then((o=>{o.status&&i.push(e)})))})),yield Promise.all(s),i}))}filterGroups(e,o){const s=o.map((e=>e.id));return e.filter((e=>s.indexOf(e.id)>-1))}getInitialGroupId(){return this.initialGroupId&&this.groups.find((e=>e.id===this.initialGroupId))?this.initialGroupId:this.groups[0].id}addAllParticipantsOption(e,o){let s;return s=o?h.a.canAddDiscussionToAll(this.forumId,{cmId:this.cmId}).then((e=>(this.canPin=!!e.canpindiscussions,this.canCreateAttachments=!!e.cancreateattachment,e.status))).catch((()=>!1)):Promise.resolve(!0),s.then((o=>(o&&e.unshift({courseid:this.courseId,id:h.b.ALL_PARTICIPANTS,name:D.I.instant("core.allparticipants")}),e)))}refreshGroups(e){const o=[l.a.invalidateActivityGroupMode(this.cmId),l.a.invalidateActivityAllowedGroups(this.cmId),h.a.invalidateCanAddDiscussion(this.forumId)];Promise.all(o).finally((()=>{this.fetchDiscussionData(!0).finally((()=>{null==e?void 0:e.complete()}))}))}returnToDiscussions(e,o){var s;this.forceLeave=!0,M.a.clearTmpFiles(this.newDiscussion.files),u.b.trigger(h.b.NEW_DISCUSSION_EVENT,{forumId:this.forumId,cmId:this.cmId,discussionIds:e,discTimecreated:o,groupId:this.showGroups&&!this.newDiscussion.postToAllGroups?this.newDiscussion.groupId:void 0},f.c.getCurrentSiteId()),(null===(s=this.splitView)||void 0===s?void 0:s.outletActivated)?(this.hasOffline=!1,this.newDiscussion.subject="",this.newDiscussion.message=null,this.newDiscussion.files=[],this.newDiscussion.postToAllGroups=!1,this.messageEditor.clearText(),this.originalData=v.a.clone(this.newDiscussion)):m.a.back()}onMessageChange(e){this.newDiscussion.message=e}add(){return Object(r.a)(this,void 0,void 0,(function*(){const e=this.forum.name,o=this.newDiscussion.subject;let s=this.newDiscussion.message||"";const i=this.newDiscussion.pin,n=this.newDiscussion.files,t=this.timeCreated||Date.now(),c={discussionsubscribe:!!this.newDiscussion.subscribe};if(!o)return _.a.showErrorModal("addon.mod_forum.erroremptysubject",!0),void 0;if(!s)return _.a.showErrorModal("addon.mod_forum.erroremptymessage",!0),void 0;const d=yield _.a.showModalLoading("core.sending",!0);s=P.a.formatHtmlLines(s),i&&(c.discussionpinned=!0);const r=this.newDiscussion.postToAllGroups?this.groupIds:[this.newDiscussion.groupId];try{const i=yield b.a.addNewDiscussion(this.forumId,e,this.courseId,o,s,n,c,r,t);i&&(b.a.deleteNewDiscussionStoredFiles(this.forumId,t),u.b.trigger(u.b.ACTIVITY_DATA_SENT,{module:"forum"})),i&&i.length<r.length&&_.a.showErrorModalDefault(null,"addon.mod_forum.errorposttoallgroups",!0),A.a.triggerFormSubmittedEvent(this.formElement,!!i,f.c.getCurrentSiteId()),this.returnToDiscussions(i,t)}catch(e){_.a.showErrorModalDefault(e,"addon.mod_forum.cannotcreatediscussion",!0)}finally{d.dismiss()}}))}discard(){return Object(r.a)(this,void 0,void 0,(function*(){try{yield _.a.showConfirm(D.I.instant("core.areyousure"));const e=[];e.push(I.a.deleteNewDiscussion(this.forumId,this.timeCreated)),e.push(v.a.ignoreErrors(b.a.deleteNewDiscussionStoredFiles(this.forumId,this.timeCreated))),yield Promise.all(e),A.a.triggerFormCancelledEvent(this.formElement,f.c.getCurrentSiteId()),this.returnToDiscussions()}catch(e){}}))}toggleAdvanced(){this.advanced=!this.advanced}calculateGroupName(){var e;return Object(r.a)(this,void 0,void 0,(function*(){if(this.newDiscussion.groupId<=0)this.postInGroupMessage=void 0;else{const o=null===(e=this.groups.find((e=>e.id===this.newDiscussion.groupId)))||void 0===e?void 0:e.name;this.postInGroupMessage=o&&D.I.instant("addon.mod_forum.postingroup",{groupname:o})}}))}canLeave(){return Object(r.a)(this,void 0,void 0,(function*(){return this.forceLeave||(b.a.hasPostDataChanged(this.newDiscussion,this.originalData)&&(yield _.a.showConfirm(D.I.instant("core.confirmcanceledit"))),M.a.clearTmpFiles(this.newDiscussion.files),this.formElement&&A.a.triggerFormCancelledEvent(this.formElement,f.c.getCurrentSiteId())),!0}))}ionViewWillLeave(){this.syncObserver&&this.syncObserver.off(),delete this.syncObserver}goBack(){var e;(null===(e=this.splitView)||void 0===e?void 0:e.outletActivated)?m.a.navigate("../../"):m.a.back()}ngOnDestroy(){var e;this.syncId&&w.a.unblockOperation(h.b.COMPONENT,this.syncId),this.isDestroyed=!0,null===(e=this.discussions)||void 0===e||e.destroy()}}return AddonModForumNewDiscussionPage.ɵfac=function AddonModForumNewDiscussionPage_Factory(e){return new(e||AddonModForumNewDiscussionPage)(N.yc(i.a),N.yc(F.a,8))},AddonModForumNewDiscussionPage.ɵcmp=N.sc({type:AddonModForumNewDiscussionPage,selectors:[["page-addon-mod-forum-new-discussion"]],viewQuery:function AddonModForumNewDiscussionPage_Query(e,o){var s;(1&e&&(N.ud(z,!0),N.ud(g.a,!0)),2&e)&&(N.dd(s=N.Nc())&&(o.formElement=s.first),N.dd(s=N.Nc())&&(o.messageEditor=s.first))},decls:16,vars:13,consts:[["slot","start"],[3,"text"],["slot","end"],[3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["newDiscFormEl",""],["position","stacked"],["type","text","name","subject",3,"ngModel","placeholder","ngModelChange"],["name","addon_mod_forum_new_discussion","contextLevel","module","elementId","message",3,"control","placeholder","component","componentId","autoSave","contextInstanceId","contentChanged"],["button","","detail","false","role","heading","aria-controls","addon-mod-forum-new-discussion-advanced",1,"divider","ion-text-wrap",3,"click"],["name","fas-chevron-right","flip-rtl","","slot","start","aria-hidden","true",1,"expandable-status-icon"],["id","addon-mod-forum-new-discussion-advanced",4,"ngIf"],["class","addon-forum-group-info",4,"ngIf"],[1,"addon-forum-new-discussion-buttons"],["expand","block",3,"disabled","click"],["id","addon-mod-forum-new-discussion-advanced"],["class","core-edit-set-group",4,"ngIf"],["name","subscribe",3,"ngModel","ngModelChange"],[3,"files","maxSize","maxSubmissions","component","componentId","allowOffline","courseId",4,"ngIf"],["name","postallgroups",3,"ngModel","ngModelChange"],[1,"core-edit-set-group"],["interface","action-sheet","name","groupid",3,"ngModel","disabled","interfaceOptions","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["contextLevel","course",3,"text","contextInstanceId","wsNotFiltered"],["name","pin",3,"ngModel","ngModelChange"],[3,"files","maxSize","maxSubmissions","component","componentId","allowOffline","courseId"],[1,"addon-forum-group-info"],["name","fas-circle-info","slot","start","aria-hidden","true"],["expand","block","fill","outline",3,"click"]],template:function AddonModForumNewDiscussionPage_Template(e,o){1&e&&(N.Ec(0,"ion-header"),N.Ec(1,"ion-toolbar"),N.Ec(2,"ion-buttons",0),N.zc(3,"ion-back-button",1),N.Pc(4,"translate"),N.Dc(),N.Ec(5,"ion-title"),N.Ec(6,"h1"),N.pd(7),N.Pc(8,"translate"),N.Dc(),N.Dc(),N.zc(9,"ion-buttons",2),N.Dc(),N.Dc(),N.Ec(10,"ion-content",3),N.Ec(11,"ion-refresher",4),N.Mc("ionRefresh",(function AddonModForumNewDiscussionPage_Template_ion_refresher_ionRefresh_11_listener(e){return o.refreshGroups(e.target)})),N.zc(12,"ion-refresher-content",5),N.Pc(13,"translate"),N.Dc(),N.Ec(14,"core-loading",6),N.nd(15,AddonModForumNewDiscussionPage_form_15_Template,31,34,"form",7),N.Dc(),N.Dc()),2&e&&(N.lc(3),N.Vc("text",N.Qc(4,7,"core.back")),N.lc(4),N.qd(N.Qc(8,9,"addon.mod_forum.addanewdiscussion")),N.lc(3),N.Vc("core-swipe-navigation",o.discussions),N.lc(1),N.Vc("disabled",!o.groupsLoaded),N.lc(1),N.Wc("pullingText",N.Qc(13,11,"core.pulltorefresh")),N.lc(2),N.Vc("hideUntil",o.groupsLoaded),N.lc(1),N.Vc("ngIf",o.showForm))},directives:[E.C,E.Ab,E.m,E.h,E.i,E.yb,T.a,E.v,S.a,E.bb,E.cb,G.a,x.t,a.H,a.s,a.t,E.I,E.O,E.H,E.Pb,a.r,a.u,g.a,E.D,V.a,E.hb,E.u,j.a,E.l,E.zb,E.d,E.lb,E.Ob,x.s,E.mb,L.a,k.a],pipes:[R.d],styles:["[_nghost-%COMP%]   .addon-forum-group-info[_ngcontent-%COMP%] > ion-icon[slot][_ngcontent-%COMP%]{color:var(--ion-color-info);margin-right:16px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-forum-group-info[_ngcontent-%COMP%] > ion-icon[slot][_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:16px;margin-inline-end:16px}}[_nghost-%COMP%]   .addon-forum-new-discussion-buttons[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .addon-forum-new-discussion-buttons[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}"]}),AddonModForumNewDiscussionPage})();class new_discussion_AddonModForumNewDiscussionDiscussionsSwipeManager extends y.a{getSelectedItemPathFromRoute(e){return`${this.getSource().DISCUSSIONS_PATH_PREFIX}new/${e.params.timeCreated}`}}const q=[{path:"",component:Q,canDeactivate:[t.a]}];let B=(()=>{class AddonForumNewDiscussionLazyModule{}return AddonForumNewDiscussionLazyModule.ɵmod=N.wc({type:AddonForumNewDiscussionLazyModule}),AddonForumNewDiscussionLazyModule.ɵinj=N.vc({factory:function AddonForumNewDiscussionLazyModule_Factory(e){return new(e||AddonForumNewDiscussionLazyModule)},imports:[[i.m.forChild(q),d.a,n.a,c.a]]}),AddonForumNewDiscussionLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&N.kd(B,{declarations:[Q],imports:[i.m,d.a,n.a,c.a]}))}}]);