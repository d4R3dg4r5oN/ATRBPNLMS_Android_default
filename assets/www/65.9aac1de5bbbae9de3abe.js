(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{agUm:function(e,o,s){"use strict";s.r(o),s.d(o,"CoreCoursesDashboardLazyModule",(function(){return E}));var a=s("tyNb"),r=s("L3Fv"),n=s("5p9q"),t=s("mrSG"),i=s("Xzvb"),c=s("fjkH"),l=s("9+EE"),d=s("OYIH"),u=s("3LXp"),b=s("mSZx"),h=s("pHTc"),_=s("6akD"),C=s("fXoL"),p=s("ACV2"),f=s("ofXK"),g=s("nt/U"),m=s("TEn/"),D=s("PgjG"),k=s("ACYt"),v=s("3CSS"),y=s("aSim"),P=s("r8G5"),I=s("sYmb");function CoreCoursesDashboardPage_ion_button_1_Template(e,o){if(1&e){const e=C.Fc();C.Ec(0,"ion-button",8),C.Mc("click",(function CoreCoursesDashboardPage_ion_button_1_Template_ion_button_click_0_listener(){C.fd(e);return C.Oc().openSearch()})),C.Pc(1,"translate"),C.zc(2,"ion-icon",9),C.Dc()}2&e&&C.mc("aria-label",C.Qc(1,1,"core.courses.searchcourses"))}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template(e,o){if(1&e&&C.zc(0,"core-block",13),2&e){const e=C.Oc().$implicit,o=C.Oc(2);C.Vc("block",e)("instanceId",o.userId)}}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template(e,o){if(1&e&&(C.Cc(0),C.nd(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template,1,2,"core-block",12),C.Bc()),2&e){const e=o.$implicit;C.lc(1),C.Vc("ngIf",e.visible)}}function CoreCoursesDashboardPage_ion_list_7_Template(e,o){if(1&e&&(C.Ec(0,"ion-list",10),C.nd(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template,2,1,"ng-container",11),C.Dc()),2&e){const e=C.Oc();C.lc(1),C.Vc("ngForOf",e.blocks)}}function CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template(e,o){if(1&e&&C.zc(0,"core-block-side-blocks-button",14),2&e){const e=C.Oc();C.Vc("instanceId",e.userId)}}function CoreCoursesDashboardPage_core_empty_box_9_Template(e,o){1&e&&(C.zc(0,"core-empty-box",15),C.Pc(1,"translate")),2&e&&C.Vc("message",C.Qc(1,1,"core.course.nocontentavailable"))}let S=(()=>{class CoreCoursesDashboardPage{constructor(){this.hasMainBlocks=!1,this.hasSideBlocks=!1,this.searchEnabled=!1,this.downloadCourseEnabled=!1,this.downloadCoursesEnabled=!1,this.blocks=[],this.loaded=!1,this.updateSiteObserver=c.b.on(c.b.SITE_UPDATED,(()=>{this.searchEnabled=!i.a.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.a.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.a.isDownloadCoursesDisabledInSite()}),l.c.getCurrentSiteId())}ngOnInit(){this.searchEnabled=!i.a.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.a.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.a.isDownloadCoursesDisabledInSite(),this.loadContent()}loadContent(){return Object(t.a)(this,void 0,void 0,(function*(){const e=yield d.a.isAvailable(),o=yield d.a.isDisabled();if(e&&!o){this.userId=l.c.getCurrentSiteUserId();try{const e=yield d.a.getDashboardBlocks();this.blocks=e.mainBlocks,this.hasMainBlocks=_.a.hasSupportedBlock(e.mainBlocks),this.hasSideBlocks=_.a.hasSupportedBlock(e.sideBlocks)}catch(e){u.a.showErrorModal(e),this.loadFallbackBlocks()}}else e?this.blocks=[]:this.loadFallbackBlocks();this.loaded=!0}))}loadFallbackBlocks(){this.blocks=[{name:"myoverview",visible:!0},{name:"timeline",visible:!0}],this.hasMainBlocks=_.a.isBlockSupported("myoverview")||_.a.isBlockSupported("timeline")}refreshDashboard(e){var o;const s=[];s.push(d.a.invalidateDashboardBlocks()),null===(o=this.blocksComponents)||void 0===o||o.forEach((e=>{s.push(e.invalidate().catch((()=>{})))})),Promise.all(s).finally((()=>{this.loadContent().finally((()=>{null==e?void 0:e.complete()}))}))}openSearch(){return Object(t.a)(this,void 0,void 0,(function*(){h.a.navigateToSitePath("/courses/list",{params:{mode:"search"}})}))}ngOnDestroy(){this.updateSiteObserver.off()}}return CoreCoursesDashboardPage.ɵfac=function CoreCoursesDashboardPage_Factory(e){return new(e||CoreCoursesDashboardPage)},CoreCoursesDashboardPage.ɵcmp=C.sc({type:CoreCoursesDashboardPage,selectors:[["page-core-courses-dashboard"]],viewQuery:function CoreCoursesDashboardPage_Query(e,o){var s;(1&e&&C.ud(b.a,!0),2&e)&&(C.dd(s=C.Nc())&&(o.blocksComponents=s))},decls:10,vars:9,consts:[["slot","end","prepend",""],[3,"click",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","list-item-limited-width",4,"ngIf"],["slot","fixed","contextLevel","user",3,"instanceId",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[3,"click"],["name","fas-magnifying-glass","slot","icon-only","aria-hidden","true"],[1,"list-item-limited-width"],[4,"ngFor","ngForOf"],["contextLevel","user",3,"block","instanceId",4,"ngIf"],["contextLevel","user",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesDashboardPage_Template(e,o){1&e&&(C.Ec(0,"core-navbar-buttons",0),C.nd(1,CoreCoursesDashboardPage_ion_button_1_Template,3,3,"ion-button",1),C.Dc(),C.Ec(2,"ion-content"),C.Ec(3,"ion-refresher",2),C.Mc("ionRefresh",(function CoreCoursesDashboardPage_Template_ion_refresher_ionRefresh_3_listener(e){return o.refreshDashboard(e.target)})),C.zc(4,"ion-refresher-content",3),C.Pc(5,"translate"),C.Dc(),C.Ec(6,"core-loading",4),C.nd(7,CoreCoursesDashboardPage_ion_list_7_Template,2,1,"ion-list",5),C.nd(8,CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template,1,1,"core-block-side-blocks-button",6),C.nd(9,CoreCoursesDashboardPage_core_empty_box_9_Template,2,3,"core-empty-box",7),C.Dc(),C.Dc()),2&e&&(C.lc(1),C.Vc("ngIf",o.searchEnabled),C.lc(2),C.Vc("disabled",!o.loaded),C.lc(1),C.Wc("pullingText",C.Qc(5,7,"core.pulltorefresh")),C.lc(2),C.Vc("hideUntil",o.loaded),C.lc(1),C.Vc("ngIf",o.hasMainBlocks),C.lc(1),C.Vc("ngIf",o.hasSideBlocks),C.lc(1),C.Vc("ngIf",!o.hasMainBlocks))},directives:[p.a,f.t,g.a,m.v,m.bb,m.cb,D.a,k.a,m.l,m.D,v.a,m.P,f.s,b.a,y.a,P.a],pipes:[I.d],encapsulation:2}),CoreCoursesDashboardPage})();const w=[{path:"",component:S}];let E=(()=>{class CoreCoursesDashboardLazyModule{}return CoreCoursesDashboardLazyModule.ɵmod=C.wc({type:CoreCoursesDashboardLazyModule}),CoreCoursesDashboardLazyModule.ɵinj=C.vc({factory:function CoreCoursesDashboardLazyModule_Factory(e){return new(e||CoreCoursesDashboardLazyModule)},imports:[[a.m.forChild(w),r.a,n.a],a.m]}),CoreCoursesDashboardLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&C.kd(E,{declarations:[S],imports:[a.m,r.a,n.a],exports:[a.m]}))}}]);